<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Google Docs</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link id="favicon" rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/e/ec/GDocs_Favicon_Recreation.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:Inter,sans-serif;
  background:#0f1115;
  color:#fff;
  overflow-x:hidden;
  transition:.25s
}
#stars{position:fixed;inset:0;z-index:0;pointer-events:none}
.site{position:relative;z-index:2;min-height:100vh}

header{
  padding:32px 20px 24px;
  text-align:center;
}
header h1{font-size:2.2rem;font-weight:700}
header p{color:#9aa0aa;margin-top:6px}

.search-wrap{
  margin:20px auto 0;
  max-width:520px;
  display:flex;
  gap:10px;
  justify-content:center;
}
.search-wrap input{
  flex:1;
  padding:12px 16px;
  border-radius:14px;
  border:none;
  background:#1c1f28;
  color:#fff;
  font-size:1rem;
}
.search-wrap button{
  padding:12px 16px;
  border:none;
  border-radius:14px;
  background:#2c3040;
  color:#fff;
  cursor:pointer
}
.search-wrap button:hover{background:#3a4060}

.games-wrapper{max-width:1300px;margin:0 auto;padding:30px 20px}
.games-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:18px
}
.game-card{
  background:#161922;
  border-radius:18px;
  overflow:hidden;
  cursor:pointer;
  transition:.18s;
  box-shadow:0 6px 18px rgba(0,0,0,.25)
}
.game-card:hover{
  transform:translateY(-6px);
  box-shadow:0 14px 30px rgba(0,0,0,.45)
}
.game-thumb{
  aspect-ratio:1/1;
  background:#222 center/cover no-repeat;
  position:relative
}
.play-overlay{
  position:absolute;inset:0;
  display:flex;align-items:center;justify-content:center;
  background:rgba(0,110,255,.15);
  font-weight:700;
  opacity:0;
  transition:.15s
}
.game-card:hover .play-overlay{opacity:1}
.game-info{padding:12px 14px}
.game-title{
  font-weight:600;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis
}

/* MODAL */
.modal-bg{
  position:fixed;inset:0;
  background:rgba(0,0,0,.7);
  display:flex;align-items:center;justify-content:center;
  z-index:1000
}
.modal-window{
  width:92%;max-width:700px;
  background:#181b24;
  border-radius:16px;
  overflow:hidden
}
.modal-header{
  padding:14px 18px;
  background:#20232d;
  display:flex;justify-content:space-between;
  font-weight:600
}
.modal-content{
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:16px
}
select{
  width:100%;
  padding:12px;
  border-radius:12px;
  background:#1c1f28;
  color:#fff;
  border:none;
  appearance:none
}

/* THEMES */
.theme-light{background:#f4f6fb;color:#111}
.theme-midnight{background:#05070c}
.theme-ocean{background:#071a2f}
.theme-rose{background:#2b1218}
.theme-slate{background:#12151c}
</style>
</head>

<body>
<canvas id="stars"></canvas>

<div class="site">
<header>
  <h1 id="siteTitle">Google Docs</h1>
  <p>Instant play. No limits. Just games.</p>

  <div class="search-wrap">
    <input id="search" placeholder="Search games...">
    <button id="settingsBtn">⚙</button>
  </div>
</header>

<main class="games-wrapper">
  <div class="games-grid" id="grid"></div>
</main>
</div>

<script>
/* ===== about:blank iframe ===== */
if(localStorage.openBlank==="1" && location.hostname){
  const win = window.open("about:blank","_self");
  win.document.write(`
    <style>html,body,iframe{margin:0;height:100%;width:100%;border:none}</style>
    <iframe src="${location.href}"></iframe>
  `);
}

/* ===== Game loader ===== */
const user="cleverman456", repo="googledocsalt.github.io";
const grid=document.getElementById("grid");

fetch(`https://api.github.com/repos/${user}/${repo}/contents/assets`)
.then(r=>r.json())
.then(files=>{
  files.filter(f=>f.name.endsWith(".html")).forEach(f=>{
    const slug=f.name.replace(".html","");
    const card=document.createElement("div");
    card.className="game-card";
    card.dataset.title=slug.toLowerCase();
    card.innerHTML=`
      <div class="game-thumb">
        <div class="play-overlay">▶ Play</div>
      </div>
      <div class="game-info">
        <div class="game-title">${slug.replace(/-/g," ")}</div>
      </div>`;
    card.onclick=()=>openGame(slug);
    grid.appendChild(card);
  });
});

function openGame(slug){
  const m=document.createElement("div");
  m.className="modal-bg";
  m.innerHTML=`
    <div class="modal-window">
      <div class="modal-header">
        <span>${slug}</span>
        <span onclick="this.closest('.modal-bg').remove()">✖</span>
      </div>
      <iframe src="assets/${slug}.html" style="border:none;height:70vh"></iframe>
    </div>`;
  document.body.appendChild(m);
}

/* ===== Search ===== */
document.getElementById("search").oninput=e=>{
  const q=e.target.value.toLowerCase();
  document.querySelectorAll(".game-card").forEach(c=>{
    c.style.display=c.dataset.title.includes(q)?"":"none";
  });
};

/* ===== Settings ===== */
const themes={
  Dark:"", Light:"theme-light", Midnight:"theme-midnight",
  Ocean:"theme-ocean", Rose:"theme-rose", Slate:"theme-slate"
};
const cloaks={
  "Google Docs":["Google Docs","https://upload.wikimedia.org/wikipedia/commons/e/ec/GDocs_Favicon_Recreation.png"],
  "Google Drive":["Google Drive","https://ssl.gstatic.com/images/branding/product/2x/drive_2020q4_48dp.png"],
  "Clever":["Clever","https://www.clever.com/favicon.ico"],
  "Google Classroom":["Classes","https://ssl.gstatic.com/classroom/favicon.png"],
  "Canvas":["Dashboard","https://canvas.instructure.com/favicon.ico"]
};

document.getElementById("settingsBtn").onclick=()=>{
  const m=document.createElement("div");
  m.className="modal-bg";
  m.innerHTML=`
  <div class="modal-window">
    <div class="modal-header">
      <span>Settings</span>
      <span onclick="this.closest('.modal-bg').remove()">✖</span>
    </div>
    <div class="modal-content">
      <label><input type="checkbox" id="blank"> Open in about:blank</label>
      <select id="theme"></select>
      <select id="cloak"></select>
      <button id="apply">Apply</button>
    </div>
  </div>`;
  document.body.appendChild(m);

  const tSel=document.getElementById("theme");
  Object.keys(themes).forEach(t=>tSel.innerHTML+=`<option>${t}</option>`);

  const cSel=document.getElementById("cloak");
  Object.keys(cloaks).forEach(c=>cSel.innerHTML+=`<option>${c}</option>`);

  document.getElementById("apply").onclick=()=>{
    document.body.className=themes[tSel.value];
    document.title=cloaks[cSel.value][0];
    favicon.href=cloaks[cSel.value][1];
    localStorage.openBlank=document.getElementById("blank").checked?"1":"";
    m.remove();
  };
};
</script>
</body>
</html>
